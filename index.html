<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@picocss/pico@2/css/pico.min.css" />
    <title>Fetch JSON Data with jQuery</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  </head>
  <body>
    <h2>Fetch JSON Data and Display in Table using jQuery</h2>
    <div class="row form-input">
	    <input id="orcid_url" type="url" required placeholder="ORCID URL" />
	    <input type="button" id="fetchData" value="Fetch Data" />
    </div>
    <div id="dataContainer" class="container"></div>
    <textarea id="json" name="summary" rows="5" readonly></textarea>

    <script>
      $(document).ready(function() {
        $("#fetchData").click(function() {
          $.getJSON($("#orcid_url").val(), function(data) {
            // Create the table element
            let table = $("<table>");

            // Create the table header
            let thead = $("<thead>");
            let headerRow = $("<tr>");
            headerRow.append("<th>Title</th>");
            thead.append(headerRow);
            table.append(thead);
            // $("#json").val(JSON.stringify(data));
            $("#json").val(data.group[0]);

            // Create the table body
            let tbody = $("<tbody>");
            $.each(data.group, function(index, item) {
              let row = $("<tr>");
		    row.append("<td>" + item["work-summary"]["title"]["title"]["value"] + "</td>");
              row.append("</tr>");
              tbody.append(row);
            });
            tbody.append("</tbody>");
            table.append(tbody);

            // Append the table to the container
            $("#dataContainer").html(table);
          }).fail(function(jqXHR, textStatus, errorThrown) {
            console.error("Error fetching data: ", textStatus, errorThrown);
          });
        });
      });
    </script>
  </body>
</html>
